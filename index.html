<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />
    <title>课程</title>
    <link rel="stylesheet" href="/course-ans/css/iconmoon/style.css">
    <link rel="stylesheet" href="/course-ans/css/common.css">
    <link rel="stylesheet" href="/course-ans/css/pop.css">
    <link rel="stylesheet" href="/course-ans/js/lib/swiper/idangerous.swiper.css">
    <link rel="stylesheet" href="/course-ans/js/lib/swiper/idangerous.swiper.scrollbar.css">
    <link rel="stylesheet" href="/course-ans/js/lib/layui-v2.5.4/layui/css/layui.css">
    <link rel="stylesheet" href="/course-ans/css/style.css">
    <link rel="stylesheet" href="/course-ans/css/coursePortal/portal-app.css?_t=2023-0721-1900">
    <script src="/course-ans/js/phone/protocolChaoXing/CXJSBridge.js"></script>
    <script src="/mooc-ans/js/ServerHost.js?v=2023-0722-1400" type="text/javascript" charset="utf-8"></script>
</head>
<style>
    body,
    html {
        background: #fff;
    }

    .check-standard strong {
        font-weight: bold;
    }

    .check-standard img {
        width: 100%;
    }

    .check-standard table {
        width: 100%;
        table-layout: fixed;
        overflow-wrap: break-word;
    }

    .check-standard tr {
        width: 100%;
    }

    .check-standard td {
        width: 100%;
    }
</style>
<body>
    <div class="course-portal">
        <input type="hidden" id="signupnowtip" value='立即报名' />
        <input type="hidden" id="entercoursetip" value='进入课程' />
        <input type="hidden" id="courseId" value="208843967" />
        <input type="hidden" id="clazzId" value="17915922" />
        <input type="hidden" id="cpi" value="0" />
        <input type="hidden" id="bmScope" value="1" />
        <input type="hidden" id="teamteachersize" value="3" />
        <input type="hidden" id="teachResHiddenState" value="false" />
        <input type="hidden" id="chpaterHiddenState" value="false" />
        <input type="hidden" id="hiddenCourseEvaluate" value="false" />
        <input type="hidden" id="hiddenCourseStar" value="0" />
        <input type="hidden" id="isMappingCourse" value="0" />
        <input type="hidden" id="belongSchoolId" value="206" />
        <input type="hidden" id="courseName" value="数据科学与工程数学基础" />
        <input type="hidden" id="userId" value="" />
        <input type="hidden" id="curUserCpi" value="0" />
        <input type="hidden" id="teacherReview" value="0" />
        <input type="hidden" id="userLoginStatus" name="userLoginStatus" value="0" />
        <input type="hidden" id="readTip" name="readTip" value='该章节不能试读！' />
        <input type="hidden" id="readTip2" name="readTip2" value='该章节不能试读，若要继续学习，请点击"进入课程"进行学习。' />
        <video controls class="top-bg" poster="https://p.ananas.chaoxing.com/star3/origin/53c8d26ba310a822ad8b3447.jpg">
            <source
                src="https://s1.ananas.chaoxing.com/sv-w5/video/c2/1d/d1/932393be4b60932c4b5884dfe2ed8b7f/sd.mp4?at_=1694583199857&ak_=7340ae90f28d459a32e0a171d66cf3d1&ad_=25afb57ef6be99fa1b4fb94d55923637"
                type="video/mp4">
        </video>
        <div class="portal-con">
            <div class="course-name">数据科学与工程数学基础</div>
            <p class="speaker-box">
                <span class="speaker-item">华东师范大学</span>
                <span class="line"></span>
                <span class="speaker-item">
                    <span class="title">主讲：</span><span>黄定江</span>
                </span>
            </p>
            <div class="star">
                <div class="star-box"></div>
            </div>
            <div class="tab-list">
                <li class="active">详情</li>
                <li>目录</li>
                <li>评价</li>
            </div>
            <div class="con-list">
                <div class="cl-lab">
                    <div class="course-introduce">
                        <h3>课程介绍</h3>
                        <p>《数据科学与工程数学基础》主要介绍数据科学、人工智能和机器学习领域所需的核心数学基础知识，涉及矩阵计算、概率和信息论基础、优化基础。内容按照从模式分析到数据分析再到数学基础的思路来组织，围绕数据分析系统的核心构成：表示、模型和学习形成数据线和数学线两条线。数据线按照数据分析的处理流程、通过大量翔实的案例作为导引，引出所需数学；数学线紧扣数据线，按照知识内容发生的内在自然逻辑顺序展开。两者相辅相成，构成从具体到抽象、从抽象到具体的闭环。本课程在数据科学的定位类似于《离散数学》在计算机科学的定位，配有相当数量的习题，可作为数据科学与大数据技术、人工智能、计算机科学和软件工程等相关专业的本科生或研究生的数学基础课程，也可作为学术和工业界科技人员了解和应用数据科学与大数据技术数学基础的参考课程。
                        </p>
                    </div>
                    <div class="teaching-team">
                        <p class="public-title"><span class="icon"></span><span>教师团队</span></p>
                        <ul class="item-box">
                            <li>
                                <div class="img-box">
                                    <img src="https://p.ananas.chaoxing.com/star3/origin/5d0a9a51749ce7178efad19530ed6fb3.jpg"
                                        alt="">
                                </div>
                                <div class="text-box">
                                    <p class="text1">
                                        <span class="name overHidden1">黄定江</span>
                                        <span class="job overHidden1">
                                            华东师范大学
                                            ｜ 数据科学与工程学院
                                            ｜ 教授
                                        </span>
                                    </p>
                                    <p class="text2">
                                        研究领域<br />研究兴趣包括机器学习与人工智能，特别是在线学习和深度学习，及其在计算金融、计算机视觉和模式识别、政府治理和智能教育等跨领域的大数据解析和应用研究等。<br />论文与著作<br />近年来以第一作者身份在国内外重要学术会议和期刊如ICLR,IJCAI,TIST,TKDE,JDE等发表论文近40篇。<br />代表性论文：<br />—&nbsp;Ningyuan
                                        Zheng,&nbsp;Yifan Jiang, Dingjiang Huang.&nbsp;StrokeNet: A Neural Painting
                                        Environment.&nbsp;The International Conference on Learning Representations
                                        (ICLR2019),&nbsp;2019,1-12.&nbsp;<br />—&nbsp;Dingjiang Huang, Shunchang Yu, Bin
                                        Li, Steven Hoi and Shuigeng Zhou.&nbsp;Combination Forecasting Reversion
                                        Strategy for Online Portfolio Selection&nbsp;ACM Transactions on Intelligent
                                        Systems and Technology, 2018, 9(5) ,58:1-27.<br />—&nbsp;Bin Li, Jialei
                                        Wang,&nbsp;Dingjiang Huang,&nbsp;Steven Hoi. Transaction Costs Optimization for
                                        Online Portfolio Selection. Quantitative Finance, 2017, 17(8):
                                        1-14.<br />—&nbsp;Dingjiang Huang, Junlong Zhou, Bin Li, Steven Hoi and Shuigeng
                                        Zhou.&nbsp;Robust Median Reversion Strategy for On-Line Portfolio
                                        Selection.&nbsp;IEEE Transactions on Knowledge and Data Engineering, 2016,
                                        28(9): 2480-2493.<br />—&nbsp;Dingjiang Huang,&nbsp;Yan Zhu, Bin Li, Shuigeng
                                        Zhou and Steven Hoi.&nbsp;Semi-Universal Portfolio with Transaction
                                        Costs.&nbsp;Proceedings of the Twenty-Fourth International Joint Conference on
                                        Artificial Intelligence&nbsp;(IJCAI2015), 178-184, 2015.<br />—&nbsp;Dingjiang
                                        Huang, Junlong Zhou, Bin Li, Steven Hoi and Shuigeng Zhou.&nbsp;Robust Mean
                                        Reversion Strategy for Online Portfolio Selection.&nbsp;Proceedings of the
                                        Twenty-Third International Joint Conference on Artificial
                                        Intelligence&nbsp;(IJCAI2013),&nbsp;2006-2012, 2013.&nbsp;<br />—&nbsp;Dingjiang
                                        Huang, Nataliya M. Ivanova,&nbsp;Algorithmic framework for group analysis of
                                        differential equations and its application to generalized Zakharov-Kuznetsov
                                        equations,&nbsp;J. Differential Equations,&nbsp;2016, 260:
                                        2354-2382.&nbsp;<br />—&nbsp;Dingjiang Huang, Shuigeng
                                        Zhou.&nbsp;Group-theoretical analysis of variable coefficient nonlinear
                                        telegraph &nbsp;equations.&nbsp;Acta Appl Math,&nbsp;2012,
                                        117:135–183.<br />—&nbsp;Dingjiang Huang, Qinmin Yang and Shuigeng
                                        Zhou,&nbsp;Group properties and invariant solutions of a sixth-order thin film
                                        equation in viscous fluid.&nbsp;J. Math. Phys.&nbsp;2013, 54:
                                        013510(1-12).<br />—&nbsp;Dingjiang Huang, Shuigeng Zhou.&nbsp;Group Properties
                                        of Generalized Quasi-linear Wave Equations,&nbsp;J. Math. Anal. Appl,&nbsp;2010,
                                        366: 460-472.<br />—&nbsp;Dingjiang Huang&nbsp;and Nataliya M.Ivanova. Group
                                        analysis and exact solutions of a class of variable coefficient nonlinear
                                        telegraph equations.&nbsp;J. Math. Phys.,&nbsp;2007, 48: 073507. (23
                                        pages).&nbsp;<br />荣誉与奖励</p>
                                </div>
                            </li>
                            <li>
                                <div class="img-box">
                                    <img src="https://p.ananas.chaoxing.com/star3/origin/976474d3ff1a8bcf3a4575e6a3ae9e81.png"
                                        alt="">
                                </div>
                                <div class="text-box">
                                    <p class="text1">
                                        <span class="name overHidden1">郝珊锋</span>
                                        <span class="job overHidden1">
                                            华东师范大学
                                            ｜ 数据科学与工程学院
                                        </span>
                                    </p>
                                    <p class="text2"></p>
                                </div>
                            </li>
                            <li>
                                <div class="img-box">
                                    <img src="https://p.ananas.chaoxing.com/star3/origin/0c64df44749818d23cc5fadb3a68c8e2.jpg"
                                        alt="">
                                </div>
                                <div class="text-box">
                                    <p class="text1">
                                        <span class="name overHidden1">唐赟喆</span>
                                        <span class="job overHidden1">
                                            华东师范大学
                                            ｜ 数据科学与工程学院
                                        </span>
                                    </p>
                                    <p class="text2"></p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <!-- 自定义模块 start -->
                    <div class="check-standard">
                        <p class="public-title"><span class="icon"></span><span>参考教材</span></p>
                        <ul class="module-list">
                        </ul>
                        <div class="atta-name">
                            <p>参考教材：黄定江，《数据科学与工程数学基础》，即将于2020年暑期出版。<br /></p>
                        </div>
                    </div>
                    <!-- 自定义模块 end -->
                </div>
                <div class="cl-lab" style="display: none;">
                    <ul class="chapter-list"></ul>
                </div>
                <div class="cl-lab" style="display: none;">
                    <div class="top-box">
                        <span class="num">共 <font id="showEvaluateCount">0</font> 条</span>
                        <a href="javascript:openCourseEvaluate()" class="blue-btn evaluate-btn"
                            style="display: none;"><i></i>写评价</a>
                    </div>
                    <ul class="evaluate-box"></ul>
                </div>
            </div>
            <div class="bottom-div" style="display: none;">
                <input type="hidden" id="loginState" value="0" />
                <input type="hidden" id="jumpUrl" value="" />
                <input type="hidden" id="jumpClzUrl" value="" />
                <div class="btn">加入课程</div>
            </div>
        </div>
        <!-- 选择班级 -->
        <div class="maskDiv select-class" style="display: none;">
            <div class="popDiv">
                <div class="popHead">选择要加入的班级</div>
                <div style="height: 48px;"></div>
                <ul class="class-box">
                </ul>
                <div style="height: 56px;"></div>
                <div class="popBottom">取消</div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="/course-ans/js/common/jquery.min.js"></script>
    <script type="text/javascript" src="/course-ans/js/common/jquery-migrate.min.js"></script>
    <script type="text/javascript" src="/course-ans/js/jquery.nicescroll.min.js"></script>
    <script type="text/javascript" src="/course-ans/js/lib/swiper/idangerous.swiper.min.js"></script>
    <script type="text/javascript" src="/course-ans/js/lib/swiper/idangerous.swiper.scrollbar.min.js"></script>
    <script type="text/javascript" src="/course-ans/js/common/common.js"></script>
    <script type="text/javascript" src="/course-ans/js/lib/layui-v2.5.4/layui/layui.js"></script>
    <script type="text/javascript" src="/course-ans/js/lib/echarts.min.js"></script>
    <script type="text/javascript" src="/course-ans/js/manage/tabs.js"></script>
    <script src="/course-ans/js/pop.js"></script>
    <link href="/ananas/ueditor/themes/iframe_wap.css?v=2023-0322-1016" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="/ananas/ext-4.2.0.663/ext.js"></script>
    <script type="text/javascript" charset="utf-8"
        src="/course-ans/js/editor/ueditor.parse2Mobile.js?v=2023-0323-1500"></script>
    <script type="text/javascript" src="/course-ans/js/course/portalpreview2mobile.js?v=2023-2412-1500"></script>
    <!-- <script type="text/javascript" src="/course-ans/js/coursePortal/coursePortalApp.js"></script> -->
    <script>
        uParse(".check-standard");
        var clazzId = "";
        var loginState = 0;
        $(function () {
            loadChapterList();
            loadCourseevaluate();
            // rateList()
            tabClick();
            // openClick()
            // showPop();
            loadPortalbtnstate();
        })
        function _jsBridgeReady() {
            jsBridge.bind('CLIENT_REFRESH_EVENT', function (object) {
                window.location.reload();
            });
        }
        /* 评分 */
        function rateList() {
            var rates1 = $(".portal-con .star-box")
            rates1.each(function (i, n) {
                $(n).addClass("testX");
                layui.use(['rate'], function () {
                    var rate = layui.rate;
                    rate.render({
                        elem: $(n),
                        value: 3.5,
                        text: true,
                        readonly: true,
                        half: true,
                        setText: function (value) {
                            this.span.text(value);
                            this.span.addClass('star-value')
                        }
                    })
                })
            })
        }
        /* tab切换 */
        function tabClick() {
            $('.portal-con .tab-list>li').click(function () {
                var index = $(this).index();
                $(this).addClass('active').siblings().removeClass('active');
                $('.portal-con .con-list>.cl-lab').eq(index).show().siblings().hide();
            })
            var tabTop = $('.tab-list').offset().top;
            $(window).scroll(function () {
                var top = $(document).scrollTop();
                if (top >= tabTop) {
                    $('.tab-list').addClass('fixed')
                    $('.con-list').addClass('top')
                } else {
                    $('.tab-list').removeClass('fixed')
                    $('.con-list').removeClass('top')
                }
            })

            // 发表评论后跳转到评价页
            if (location.href.indexOf("&toEvaluation=true") > -1) {
                var tabListObj = $('.portal-con .tab-list>li');
                if (tabListObj && tabListObj.length > 1) {
                    tabListObj.eq(2).trigger('click');
                }
            }
        }
        /* 目录展开收起 */
        function openClick() {
            $('.chapter-title').click(function () {
                $(this).toggleClass('active')
                $(this).siblings('.section-list').slideToggle()
            })
        }
        /* 加入课程弹窗 */
        function showPop() {
            $('.course-portal .bottom-div>.btn').click(function () {
                $('.select-class').fadeIn();
                unScroll();
            })
            //关闭弹窗
            $('.course-portal .select-class .popBottom').click(function () {
                closeClsPop()
            })
            $('.course-portal .select-class .class-box>li').click(function () {
                var curl = $(this).attr("curl");
                doApplyCourse(curl);
                // var cid = $(this).attr("cid");
                // doApplyCourse(cid);
            })
        }
        function closeClsPop() {
            $('.select-class').fadeOut();
            removeUnScroll();
        }

        function loadPortalbtnstate() {
            var userId = $("#userId").val();
            var courseId = $("#courseId").val();
            clazzId = $("#clazzId").val();
            if (!userId || userId.length == 0) {
                //未登录，判断课程如果开放报名，就显示报名按钮，点击需要登录，否则隐藏报名按钮
                $.ajax({
                    type: "get",
                    url: "/course-ans/courseportal/getCourseState",
                    data: {
                        "courseId": courseId,
                        "clazzId": clazzId
                    },
                    dataType: "json",
                    success: function (backJson) {
                        var openCourse = backJson.openCourse;
                        if (openCourse == 1) {
                            $(".bottom-div .btn").html($("#signupnowtip").val());
                            $(".bottom-div .btn").click(function () {
                                var url = location.href;
                                if (url.indexOf("protalOnline") == -1) {
                                    url = url.replace("protal", "protalOnline");
                                    location.href = url;
                                }
                            });
                            $(".bottom-div").show();
                        } else {
                            $(".bottom-div").hide();
                        }
                    }
                })
                return;
            }

            $.ajax({
                type: "get",
                url: "/course-ans/courseportal/portalbtnstate",
                data: {
                    "courseId": courseId,
                    "clazzId": clazzId
                },
                dataType: "json",
                success: function (backJson) {
                    if (!backJson.status) {
                        $(".editProtalBtn").remove();
                        $(".collectionImg").remove();
                        return;
                    }

                    var data = backJson.data;
                    clazzId = data.clazzId;
                    loginState = data.loginState;

                    // 课程评价 0:公开，1：隐藏 ， 2：仅本课程下学生可以评价
                    var hiddenCourseStar = $("#hiddenCourseStar").val();
                    var hiddenCourseEvaluate = $("#hiddenCourseEvaluate").val();

                    if (loginState == 0) {
                        var bmScope = $("#bmScope").val();
                        if (bmScope == '2') {
                            loginState = 3;
                        } else {
                            //不在班，如果评论权限设置为"需教师审核"，就显示评论按钮
                            if ($("#teacherReview").val() == "1") {
                                //教师审核评价设置：默认0，无需审核，1：需教师审核
                                $(".evaluate-btn").show();
                            }
                            if (hiddenCourseStar && hiddenCourseStar == '0' && hiddenCourseEvaluate && hiddenCourseEvaluate == 'false') {
                                // 显示写评价按钮
                                $(".evaluate-btn").show();
                            }
                            return;
                        }
                    }

                    if (loginState < 3) {
                        //在班，显示评论按钮
                        $(".evaluate-btn").show();
                    } else {
                        //不在班，如果评论权限设置为"需教师审核"，就显示评论按钮
                        if ($("#teacherReview").val() == "1") {
                            //教师审核评价设置：默认0，无需审核，1：需教师审核
                            $(".evaluate-btn").show();
                        }

                        if (hiddenCourseStar && hiddenCourseStar == '0' && hiddenCourseEvaluate && hiddenCourseEvaluate == 'false') {
                            // 显示写评价按钮
                            $(".evaluate-btn").show();
                        }
                    }

                    var jumpUrl = data.jumpUrl;

                    $("#loginState").val(loginState);

                    $("#jumpUrl").val(jumpUrl);

                    var signupnowtip = $("#signupnowtip").val();
                    var entercoursetip = $("#entercoursetip").val();

                    if (loginState == 3) {
                        $(".bottom-div .btn").html(signupnowtip);
                        $(".bottom-div .btn").click(function () {
                            applyCourse();
                        });
                    } else {
                        $(".bottom-div .btn").html(loginState == 1 ? "进入课程" : "学习课程");
                        $(".bottom-div .btn").unbind("click");
                        $(".bottom-div .btn").click(function () {
                            openCourse();
                        });
                    }
                    $(".bottom-div").show();

                }
            })
        }

        //加载章节
        function loadChapterList() {
            var cl = $(".chapter-list").html();
            if (cl && cl.length) {
                return;
            }

            var courseId = $("#courseId").val();
            $.ajax({
                url: "/course-ans/moocstatistics/chapterlist",
                type: "get",
                data: {
                    courseId: courseId,
                    fromVm: 2
                },
                dataType: "html",
                success: function (data) {
                    $(".chapter-list").html(data);
                    openClick();
                    // chapterOpenOrClose();
                    // scrollResize();
                }
            })
        }

        //加载评价
        function loadCourseevaluate() {
            var ev = $(".evaluate-box").html();
            if (ev && eb.length) {
                return;
            }
            var courseId = $("#courseId").val();
            $.ajax({
                url: "/course-ans/courseportal/getcourseevaluate",
                type: "get",
                data: {
                    courseId: courseId,
                    from: 2
                },
                dataType: "html",
                success: function (data) {
                    $(".evaluate-box").html(data);
                    // var courseCanEvaluate = $("#courseCanEvaluate").val();
                    // if(courseCanEvaluate == "true"){
                    //     $(".courseEvaluateColor").addClass("text4");
                    //     $(".courseEvaluateColor").attr("onclick","toCourseEvaluate()");
                    // }
                    courseEvaluateStar();
                    // evaluateClick();
                    // if (!evaluateScorll) {
                    //     courseEvaluateScorll();
                    //     scrollResize();
                    // }
                    // setStyle();
                    var ua = navigator.userAgent;
                    if (ua && ua.indexOf("ChaoXingStudy") > -1) {
                        $(".text img").click(function () {
                            var src = $(this).attr("src");
                            var cc = {
                                "showIndex": 0,
                                "imageUrls": [
                                    {
                                        "imageUrl": src,
                                        "edit": 0,
                                        "originUrl": src,
                                        "resultType": 1,
                                        "getOriginSize": 0,
                                        "showReview": 0
                                    }
                                ]
                            };
                            jsBridge.postNotification('CLIENT_PREVIEW_IMAGES', cc);
                        });
                    } else {
                        layui.use('layer', function () {
                            var layer = layui.layer;
                            layer.photos({
                                photos: '.evaluate-box .text',
                                anim: 5
                            });
                        });
                    }

                }
            })
        }

        /* 课程评价星星 */
        function courseEvaluateStar() {
            var rates2 = $(".evaluate-box .star-box")
            rates2.each(function (i, n) {
                $(n).addClass("testX");
                var personalAvg = $(n).attr("data");
                layui.use(['rate'], function () {
                    var rate = layui.rate;
                    rate.render({
                        elem: $(n),
                        value: parseFloat(personalAvg),
                        text: true,
                        readonly: true,
                        half: true,
                        setText: function (value) {
                            this.span.text(value);
                            this.span.addClass('star-value')
                        }
                    })
                })
            })
            // var starCount = $("#starCount").val();
            var personalAvg = $("#personalAvg").val();
            // $("#showStarCount").html(starCount);
            var evaluateCount = $("#evaluateCount").val();
            $("#showEvaluateCount").html(evaluateCount);
            var rates1 = $(".star .star-box")
            rates1.each(function (i, n) {
                $(n).addClass("testX");
                layui.use(['rate'], function () {
                    var rate = layui.rate;
                    rate.render({
                        elem: $(n),
                        value: parseFloat(personalAvg),
                        text: true,
                        readonly: true,
                        half: true,
                        setText: function (value) {
                            this.span.text(value);
                            this.span.addClass('star-value')
                        }
                    })
                })
            })

        }

        //报名
        function applyCourse() {
            var bmScope = $("#bmScope").val();
            if (bmScope == '1') {
                //开放班级报名
                var jumpUrl = $("#jumpUrl").val();
                doApplyCourse(jumpUrl);
                // doApplyCourse(clazzId);
            } else if (bmScope == '2') {
                //支持全部班级报名，显示班级列表
                var courseId = $("#courseId").val();
                var url = "/course-ans/courseportal/getBmClassList?courseId=" + courseId;
                $.ajax({
                    type: "get",
                    url: url,
                    dataType: "json",
                    success: function (res) {
                        if (res.status) {
                            var data = res.data;
                            var html = '';
                            if (data && data.length) {
                                for (var i = 0; i < data.length; i++) {
                                    var cc = data[i];
                                    html += '<li class="overHidden2" cid="' + cc.id + '" curl="' + cc.jumpUrl + '">' + cc.name + '</li>';
                                }
                            }
                            $(".class-box").html(html);
                            showPop();
                            $('.select-class').fadeIn();
                        } else {
                            layui.use('layer', function () {
                                var layer = layui.layer;
                                layer.msg(res.msg, {
                                    time: 1000
                                });
                            });
                        }
                    }
                })
            }

        }

        function doApplyCourse(url) {
            // clazzId = cid;
            // var courseId = $("#courseId").val();
            // var userId = $("#userId").val();
            // var url = "/teachingClassPhoneManage/phone/participateCls?courseId="+courseId+"&classId="+cid+"&studentId="+userId;
            $.ajax({
                type: "get",
                url: url,

                dataType: "json",
                success: function (data) {
                    if (!data.succ && !data.status) {
                        layui.use('layer', function () {
                            var layer = layui.layer;
                            layer.msg(data.msg || "报名失败", {
                                time: 1000
                            });
                        });
                        return;
                    }
                    layui.use('layer', function () {
                        var layer = layui.layer;
                        layer.msg('报名成功', {
                            time: 1000
                        });
                    });
                    loadPortalbtnstate();
                },
                complete: function (xhr, ts) {
                    closeClsPop();
                }
            })
        }

        function openCourse() {
            var courseId = $("#courseId").val();
            var cpi = $("#cpi").val();
            var curUserCpi = $("#curUserCpi").val();
            var belongSchoolId = $("#belongSchoolId").val();
            var isMappingCourse = $("#isMappingCourse").val();
            var courseName = $("#courseName").val();
            var ua = navigator.userAgent;
            if (ua && ua.indexOf("ChaoXingStudy") > -1) {
                var cc;
                if (loginState == 1) {
                    cc = {
                        "cataid": "100000002",
                        "key": "tea_" + courseId,
                        "content": {
                            "id": courseId,
                            "name": courseName,
                            "isMirror": isMappingCourse || 0,
                            "fid": belongSchoolId
                        }
                    };
                } else {
                    cc = {
                        "cataid": "100000002",
                        "key": clazzId,
                        "content": {
                            "id": clazzId,
                            "course": {
                                "data": [
                                    {
                                        "id": courseId,
                                        "name": courseName
                                    }
                                ]

                            }
                        }
                    };
                }
                jsBridge.postNotification('CLIENT_OPEN_RES', cc);

            } else {
                if (loginState == 1) {
                    location.href = "/mooc-ans/course/phone/tchclazzlist?courseId=" + courseId + "&cpi=" + cpi;
                } else {
                    var backUrl = "";
                    if (window.location.href) {
                        // 移除 URL 字符串中开头的 http:// 或 https://。
                        // backUrl = window.location.href.replace(/^(https?:\/\/)/, '').replace("classId=0","classId=" + clazzId);
                        backUrl = window.location.href.replace("clazzId=0", "clazzId=" + clazzId);
                    }
                    location.href = ServerHost.widgetCourseDomain + "/widget/weixin/stucourse/index?courseId=" + courseId + "&backType=1&classId=" + clazzId + "&cpi=" + curUserCpi + "&hideToolbar=0&backUrl=" + encodeURIComponent(backUrl);
                }
            }
        }

        function openChapter(kid, readType, isPrivately, chapterNumber) {

            if (isPrivately == 1) {
                // userLoginStatus 1:已登录 2:未登录
                var userLoginStatus = $("#userLoginStatus").val();
                // loginState = 1; 教师身份 2; 学生身份显示进入课程按钮,已报名 3; 开启学生报名  0; 可以理解为未登录或者登录班级未开放学生报名
                var loginState = $("#loginState").val();
                var tip = jumpKnowledgeTips(userLoginStatus, loginState);
                alert(tip);
                return;
            } else if (isPrivately == 2 && chapterNumber > 3) {
                alert("只允许试读前三章");
                return;
            } else if (isPrivately == 3 && chapterNumber > 1) {
                alert("只允许试读第一章");
                return;
            } else if (isPrivately == 4 && typeof readType != "undefined" && readType == 1) {
                alert("不允许试读");
                return;
            }

            var courseId = $("#courseId").val();
            var courseName = $("#courseName").val();
            var cpi = $("#cpi").val();
            var ua = navigator.userAgent;
            if (ua && ua.indexOf("ChaoXingStudy") > -1) {
                if (loginState == 1) {
                    var cc = {
                        "id": courseId,
                        "activeIndex": 0,
                        "chapterList": [
                            {
                                "id": kid
                            }
                        ]
                    };
                    jsBridge.postNotification('CLIENT_OPEN_COURSE_KNOWLEDGE', cc);
                } else {
                    var cc = {
                        "attachmentType": 17,
                        "att_course": {
                            "knowledgeId": kid,
                            "forwardCourse": {
                                "chapterid": kid,
                                "course": {
                                    "data": [
                                        {
                                            "id": courseId
                                        }
                                    ]
                                }
                            }
                        }
                    };
                    jsBridge.postNotification('CLIENT_OPEN_COURSE_CHAPTER', cc);
                }

            } else {
                if (loginState == 1) {
                    // location.href = "/course-ans/moocstatistics/chapterDetail?courseId="+courseId+"&classId=" + clazzId + "&knowledgeId="+kid+"&ut=t";
                    // location.href = "//mooc1-2.chaoxing.com/course/phone/tchchapterlist?courseId="+courseId+"&cpi="+cpi+"&clazzId=" + clazzId;
                    location.href = "/mooc-ans/course/phone/chapterdata?knowledgeid=" + kid + "&courseid=" + courseId + "&clazzid=" + clazzId + "&cpi=" + cpi + "&ut=t";
                } else if (loginState == 2) {
                    location.href = "/course-ans/moocstatistics/chapterDetail2mobile?courseId=" + courseId + "&classId=" + clazzId + "&knowledgeId=" + kid + "&ut=s";
                } else {
                    location.href = "/mooc-ans/phone/nodedetailcontroller/visitnodedetail?courseId=" + courseId + "&knowledgeId=" + kid + "&isPortalVisit=true";
                }
            }
        }

        /**
         * 章节试读提示语判断 userLoginStatus 1:已登录 2:未登录
         * loginState = 1; 教师身份 2; 学生身份显示进入课程按钮 3; 开启学生报名  0; 可以理解为未登录或者登录班级未开放学生报名
         *
         */
        function jumpKnowledgeTips(userLoginStatus, loginState) {
            var readTip = $("#readTip").val();
            var readTip2 = $("#readTip2").val();
            if (userLoginStatus == '1' && loginState == '2') {
                // 4）已登录，已报名课程，提示语为：该章节不能试读，若要继续学习，请点击"进入课程"进行学习
                return readTip2;
            }
            return readTip;
        }

        function openCourseEvaluate() {
            var courseId = $("#courseId").val();
            var url = "/course-ans/courseportal/courseevaluatehead?courseId=" + courseId + "&from=2&backurl=" + encodeURIComponent(location.href);
            var ua = navigator.userAgent;
            if (ua && ua.indexOf("ChaoXingStudy") > -1) {
                url = location.protocol + "//" + document.domain + url;
                jsBridge.bind('CLIENT_WEB_EXTRAINFO', function (data) {
                    if (data.status == 1) {
                        $(".evaluate-box").html('');
                        loadCourseevaluate();
                    }
                });
                jsBridge.postNotification('CLIENT_OPEN_URL', { 'title': '写评价', 'loadType': '1', 'webUrl': url, toolbarType: '2' });
            } else {
                location.href = url;
            }
        }

        function backPage() {
            var url = "";
            window.location.href = url;
        }
    </script>
</body>
</html>